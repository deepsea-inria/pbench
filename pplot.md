% The benchmark-plot tool
% Umut Acar, Arthur Chargu√©raud, Mike Rainey
% 17 October 2014

Synopsis
========


pplot [*MODE*] [*OPTIONS_FOR_MODE*]

Description
===========

The benchmark-plot tool is a program that generates various types of
plots for given data that is generated by the benchmark-run
tool. Supported types include bar plots, scatter plots, tables, and
speedup plots. Various temporary files used to generate plots and
tables can be found in the folder `_results/`.

Options
=======

Plot modes
----------

The mode specifier *MODE* is optional: if not present, the default
plot to be generated is the bar plot. Otherwise, *MODE* can be one of
the following: `bar`, `scatter`, `table`, or `speedup`.

Mode-specific options
---------------------

### Options common to all

`-width` *n*
:    Specify width *n* of the plot to be generated (in pixels).

`-height` *n*
:    Specify height *n* of the plot to be generated (in pixels).

`-title` *t*
:    Specify the title string *t* to be displayed in the plot.

`-input` *filename*
:    Specify a file *filename* where to read results (default is `results.txt`).

`-output` *filename*
:    Specify a file *filename* where to plot results.


### Options common to `bar` and `scatter`

`-legend-pos [topright|topleft|...]`
:    Select an R code for the legend (see R codes for legend or file `legend.ml`).

`-chart` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among charts.

`-series` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among series.

`-group-by` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among groups.

`-y` *x*
:    Select the key to plot on the y axis.

`-ylabel` *lab*
:    Label the y axis as *lab*.

`-ymin` *n*
:    Set the origin of the y axis to *n*.

`-ymax` *n*
:    Set the maximum value of the y axis to *n*.

`--yzero`
:    Set the origin of the y axis to zero.

`--ylog`
:    Use a log scale for the y axis.

### Options for `scatter` only

`-xlabel` *lab*
:    Label the x axis as *lab*.

`-xmin` *n*
:    Set the origin of the x axis to *n*.

`-xmax` *n*
:    Set the maximum value of the x axis to *n*.

`--xzero`
:    Set the origin of the x axis to zero.

`-drawline` *n*
:    Draw a horizontal line originating from *n* on the y axis.

### Options for `bar` only:

`--xtitles-vertical`
:    Use a vertical orientation for the label of the x axis.

or:

`-xtitles-dir [horizontal|vertical]`
:    Set the orientation to use for the labels under the bars.

### Options for `table` only

`-table` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among
     tables.

`-row` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among
     rows of the table.

`-col` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among
     columns of the table.

`-cell` *k*
:    Select the key whose corresponding value is to be displayed in the 
     cells of the table.

`-group-by` *k1*,*k2*,...
:    Select a combination of keys by which to divide program runs among
     groups of columns in the table.

### Options for `speedup` only
   
`-chart` *k1*,*k2*,...
:    Select a combination of keys by which to divide the program runs among
     speedup charts.

`-series` *k1*,*k2*,...
:    Select a combination of keys by which to divide the program runs among
     series.

`-group-by` *k1*,*k2*,...
:    Select a combination of keys by which to divide the program runs among
     groups.

`-legend-pos [topright|topleft|...]`
:    Specify the position of the legend in the plot (see R codes for legend 
     or file `legend.ml`).

`--log`
:    Use a log scale for the speedup curves.


### Alternative syntax for providing `mode`

pplot -mode [*MODE*] [*OPTIONS_FOR_MODE*]


Examples
========

Building and running a simple experiment
----------------------------------------

The following commands build the benchmarking tools and then gather
some data from a few runs of our example program, Fibonacci.

    make -C examples/basic fib
    make prun
    prun -prog examples/basic/fib -algo recursive,cached -n 39,40 -runs 2
    make pplot

Bar plots
---------

The first plot we generate is a simple bar plot in which bars are
grouped together by arguments of `n` and apart by arguments o
`algo`. The y axis represents run time.

    pplot -x n -y exectime -series algo 

Another way to make the same bar plot is the following.

    pplot bar -x n -y exectime -series algo 

This command generates two bar plots: one for each value of algo,
namely `recursive` and `cached`.

    pplot bar -x n -y exectime -chart algo 

In this case, bars are separated by arguments of both `n` an `algo`.

    pplot bar -x n,algo -y exectime --xtitles-vertical

Scatter plots
-------------

We generate a scatter plot for the same data set as follows. Each
algorithm in the plot is represented by a labeled curve.

    pplot scatter -x n -y exectime -series algo 

Tables
------

We can generate a table showing breakdowns of run times. The columns
are represented by the values of `algo` and the rows by values of `n`.

    pplot table -row n -col algo -cell exectime

A slight change gives a similar result, but one with multiple tables
such that each table represents a different value of `algo`.

    pplot table -row n -table algo -cell exectime

Another slight changes gives a similar table where rows are
represented by combinations of values of both `n` and `algo`.

    pplot table -row n,algo -cell exectime 

Speedup plots
-------------

To generate a speedup plot, we need to use data generated by the 
`prun` tool in speedup mode.

    make prun
    prun speedup -baseline "examples/others/speedup.sh -algo foo -proc 0" -baseline-runs 1  -parallel "examples/others/speedup.sh -algo bar" -runs 2 -proc 1,2,3,4 
    pplot speedup 

We can take multiple speedup curves as well.

    prun speedup -baseline "examples/others/speedup.sh -algo foo -proc 0" -baseline-runs 1  -parallel "examples/others/speedup.sh -algo bar" -runs 2 -proc 1,2,3,4 -n 1,5
    pplot speedup -series n

